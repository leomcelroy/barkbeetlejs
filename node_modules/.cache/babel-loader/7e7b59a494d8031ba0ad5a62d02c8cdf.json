{"ast":null,"code":"import _classCallCheck from \"/Users/leomcelroy/Desktop/barkBeetleEverything/barkbeetle_js_real/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/leomcelroy/Desktop/barkBeetleEverything/barkbeetle_js_real/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/leomcelroy/Desktop/barkBeetleEverything/barkbeetle_js_real/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/leomcelroy/Desktop/barkBeetleEverything/barkbeetle_js_real/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/leomcelroy/Desktop/barkBeetleEverything/barkbeetle_js_real/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/leomcelroy/Desktop/barkBeetleEverything/barkbeetle_js_real/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport * as utils from './utils.js';\nimport * as mjs from 'makerjs';\nimport * as params from './parameters.js';\nimport * as s2p from 'shape2path';\nimport * as svgson from 'svgson';\nimport { Workplane } from './Workplane.js';\nimport { kk } from './joints/koshikake.js';\nimport { profile } from './toolpaths/profile.js';\nimport { pocket } from './toolpaths/pocket.js';\nimport { Button, Heading } from 'evergreen-ui'; //import {replaceWithPath} from './svg_to_makerjs.js';\n\nimport { MaterialType } from './components/MaterialType.js';\nimport { MaterialThickness } from './components/MaterialThickness.js';\nimport { Origin } from './components/Origin.js';\nimport { Units } from './components/Units.js';\nimport { PocketButton } from './components/PocketButton.js';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this));\n    _this.state = {\n      shapes: {},\n      toolpaths: [],\n      selected: [],\n      material: \"wood\",\n      thickness: 34,\n      units: \"mm\",\n      zero: \"bottomleft\",\n      dialogs: {\n        material_type: false\n      }\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"uploadSVG\",\n    value: function uploadSVG(e) {\n      //helper function\n      var replaceWithPath = function replaceWithPath(child) {\n        //why cant I put this in a different file\n        console.log(\"child\", child);\n\n        if (child.name === \"g\") {\n          return child.children.map(function (grandchild) {\n            return replaceWithPath(grandchild);\n          });\n        }\n\n        if (child.name === \"rectangle\") {\n          var x;\n          var y;\n          var width;\n          var height;\n          var rx;\n          var ry;\n          var temp = s2p.rect({\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n            rx: rx,\n            ry: ry\n          });\n          return mjs.importer.fromSVGPathData(temp);\n        }\n\n        if (child.name === \"circle\") {\n          var cx;\n          var cy;\n          var r;\n\n          var _temp = s2p.rect({\n            cx: cx,\n            cy: cy,\n            r: r\n          });\n\n          return mjs.importer.fromSVGPathData(_temp);\n        }\n\n        if (child.name === \"ellipse\") {\n          var _cx;\n\n          var _cy;\n\n          var _rx;\n\n          var _ry;\n\n          var _temp2 = s2p.ellipse({\n            cx: _cx,\n            cy: _cy,\n            rx: _rx,\n            ry: _ry\n          });\n\n          return mjs.importer.fromSVGPathData(_temp2);\n        }\n\n        if (child.name === \"polygon\") {\n          var points;\n\n          var _temp3 = s2p.polygon({\n            points: points\n          });\n\n          return mjs.importer.fromSVGPathData(_temp3);\n        }\n\n        if (child.name === \"polyline\") {\n          var _points;\n\n          var _temp4 = s2p.polyline({\n            points: _points\n          });\n\n          return mjs.importer.fromSVGPathData(_temp4);\n        }\n\n        if (child.name === \"line\") {\n          var x1;\n          var x2;\n          var y1;\n          var y2;\n\n          var _temp5 = s2p.line({\n            x1: x1,\n            x2: x2,\n            y1: y1,\n            y2: y2\n          });\n\n          return mjs.importer.fromSVGPathData(_temp5);\n        }\n\n        if (child.name === \"path\") {\n          var makerjsPath = mjs.importer.fromSVGPathData(child.attributes.d);\n          return makerjsPath;\n        }\n      }; //main event\n\n\n      var files = e.target.files;\n      var file = files[0];\n      var reader = new FileReader();\n\n      reader.onload = function (event) {\n        var text = event.target.result;\n        svgson.parse(text).then(function (json) {\n          var svg = json.children.map(function (child) {\n            return replaceWithPath(child);\n          });\n          svg = svg.flat(1); //TODO: what does the argument do again?\n          //TODO: update state to have makerjs models\n\n          console.log(\"svg\", svg);\n          var models = {};\n          svg.forEach(function (shape) {\n            models[utils.makeID()] = shape;\n          });\n          console.log(\"models\", models); //ultimately I will set state of app\n        });\n      };\n\n      reader.readAsText(file);\n    }\n  }, {\n    key: \"updateFromChild\",\n    value: function updateFromChild() {\n      console.log(this.state);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      //should I put everying in a list or all to one model, there seem to be some issues with origins if I mjs.exporter.toSVG() seperately\n      var test = kk; //test = mjs.model.originate(test);\n\n      var testProfile = test.models.profile;\n      var testPocket = test.models.pocket;\n      var profileCut = profile(testProfile, params);\n      var pocketCut = pocket(testPocket, params); // let drawings = [test, profile(test)];\n      // drawings = drawings.map(d => mjs.exporter.toSVG(d));\n      //testing if internal outlines will make acceptable pocket paths, appears so\n      //let p2 = pocket(testPocket, params).drawing;\n\n      var t1 = new mjs.models.Oval(20, 20);\n      var t2 = mjs.model.move(new mjs.models.Oval(20, 20), [19, 0]);\n      var test0 = mjs.model.combineUnion(t1, t2); // console.log(\"test0\", test0)\n\n      var test1 = pocket(test0, params); // console.log(test0)\n      // test0 = mjs.model.move(test0, [50, 0]);\n\n      var model = {\n        models: {\n          shapes: {\n            models: {\n              profileSource: testProfile,\n              pocketSource: testPocket //test0\n\n            }\n          },\n          cuts: {\n            models: {\n              profileCut: profileCut.drawing,\n              pocketCut: pocketCut.drawing //test1: test1.drawing\n\n            } //pocketCut2: pocket(p2, params).drawing,\n            // test0,\n            // test1,\n\n          }\n        }\n      };\n      model.models.cuts.layer = \"red\"; // model = mjs.model.originate(model);\n      // model = mjs.model.zero(model);\n\n      model['paths'] = {\n        origin: new mjs.paths.Circle(params.compensatedRadius)\n      };\n      var modelToView = mjs.model.scale(utils.deepcopy(model), 10); //TODO: make drawing easier to see, but this ruins toolpaths\n\n      var viewModel = mjs.exporter.toSVG(modelToView, {\n        useSvgPathOnly: true,\n        strokeWidth: \".5mm\" // layerOptions:{\n        //   cuts: {\n        //     stroke: \"red\"\n        //   }\n        // },\n\n      }); //viewModel = viewModel.concat(Object.values(modelToView.models).map(m => mjs.exporter.toSVG(m)));\n\n      viewModel = [viewModel]; //let p = material_type(this.state.dialogs.material_type, this);\n\n      return React.createElement(\"div\", {\n        onMouseDown: function onMouseDown(e) {\n          return console.log(\"div target\", e.target.getAttribute(\"data-route\"));\n        },\n        style: {\n          margin: 0,\n          height: \"100%\",\n          overflow: \"hidden\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, React.createElement(Workplane, {\n        groups: viewModel,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"myInput\",\n        type: \"file\",\n        ref: function ref(_ref) {\n          return _this2.upload = _ref;\n        },\n        style: {\n          display: 'none'\n        },\n        onChange: function onChange(e) {\n          return _this2.uploadSVG(e);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }), React.createElement(Button, {\n        variant: \"secondary\",\n        onClick: function onClick(e) {\n          return _this2.upload.click();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, \"upload (SVG, DXF, BBJS, or Makerjs)\"), \"\\xA0\", React.createElement(Button, {\n        onClick: function onClick() {\n          utils.download(test1.filename, test1.gcode);\n          utils.download(profileCut.filename, profileCut.gcode);\n          utils.download(pocketCut.filename, pocketCut.gcode);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, \"download gcode\"), \"\\xA0\", React.createElement(Button, {\n        isActive: false,\n        style: {\n          backgroundColor: \"#fff\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, \"save\")), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, React.createElement(Heading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, \"Settings\"), React.createElement(MaterialType, {\n        updateparent: function updateparent() {\n          return _this2.updateFromChild();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }), React.createElement(MaterialThickness, {\n        updateparent: function updateparent() {\n          return _this2.updateFromChild();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }), React.createElement(Units, {\n        updateparent: function updateparent() {\n          return _this2.updateFromChild();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }), React.createElement(Origin, {\n        updateparent: function updateparent() {\n          return _this2.updateFromChild();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      }, React.createElement(Heading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      }, \"Create Toolpaths\"), React.createElement(Button, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }, \"Profile\"), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }), React.createElement(PocketButton, {\n        updateparent: function updateparent() {\n          return _this2.updateFromChild();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      }), React.createElement(Button, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }, \"Drill\"), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271\n        },\n        __self: this\n      }, React.createElement(Heading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272\n        },\n        __self: this\n      }, \"Toolpaths\")));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/leomcelroy/Desktop/barkBeetleEverything/barkbeetle_js_real/src/App.js"],"names":["React","Component","utils","mjs","params","s2p","svgson","Workplane","kk","profile","pocket","Button","Heading","MaterialType","MaterialThickness","Origin","Units","PocketButton","App","state","shapes","toolpaths","selected","material","thickness","units","zero","dialogs","material_type","e","replaceWithPath","child","console","log","name","children","map","grandchild","x","y","width","height","rx","ry","temp","rect","importer","fromSVGPathData","cx","cy","r","ellipse","points","polygon","polyline","x1","x2","y1","y2","line","makerjsPath","attributes","d","files","target","file","reader","FileReader","onload","event","text","result","parse","then","json","svg","flat","models","forEach","shape","makeID","readAsText","test","testProfile","testPocket","profileCut","pocketCut","t1","Oval","t2","model","move","test0","combineUnion","test1","profileSource","pocketSource","cuts","drawing","layer","origin","paths","Circle","compensatedRadius","modelToView","scale","deepcopy","viewModel","exporter","toSVG","useSvgPathOnly","strokeWidth","getAttribute","margin","overflow","ref","upload","display","uploadSVG","click","download","filename","gcode","backgroundColor","updateFromChild"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport * as utils from './utils.js';\nimport * as mjs from 'makerjs';\nimport * as params from './parameters.js';\nimport * as s2p from 'shape2path';\nimport * as svgson from 'svgson';\nimport {Workplane} from './Workplane.js'\nimport {kk} from './joints/koshikake.js';\nimport {profile} from './toolpaths/profile.js';\nimport {pocket} from './toolpaths/pocket.js';\n\nimport {Button, Heading} from 'evergreen-ui';\n//import {replaceWithPath} from './svg_to_makerjs.js';\n\nimport {MaterialType} from './components/MaterialType.js'\nimport {MaterialThickness} from './components/MaterialThickness.js'\nimport {Origin} from './components/Origin.js'\nimport {Units} from './components/Units.js'\nimport {PocketButton} from './components/PocketButton.js'\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    this.state = {\n      shapes: {},\n      toolpaths:[],\n      selected: [],\n      material: \"wood\",\n      thickness: 34,\n      units: \"mm\",\n      zero: \"bottomleft\",\n      dialogs: {\n        material_type: false,\n      },\n    }\n  };\n\n  uploadSVG(e) {\n    //helper function\n    const replaceWithPath = (child) => { //why cant I put this in a different file\n      console.log(\"child\", child);\n\n      if (child.name === \"g\") {\n        return child.children.map(grandchild => replaceWithPath(grandchild));\n      }\n\n      if (child.name === \"rectangle\") {\n        let x;\n        let y;\n        let width;\n        let height;\n        let rx;\n        let ry;\n\n        let temp = s2p.rect({x, y, width, height, rx, ry});\n        return mjs.importer.fromSVGPathData(temp);\n      }\n\n      if (child.name === \"circle\") {\n        let cx;\n        let cy;\n        let r;\n\n        let temp = s2p.rect({cx, cy, r});\n        return mjs.importer.fromSVGPathData(temp);\n      }\n\n      if (child.name === \"ellipse\") {\n        let cx;\n        let cy;\n        let rx;\n        let ry;\n\n        let temp = s2p.ellipse({cx, cy, rx, ry});\n        return mjs.importer.fromSVGPathData(temp);\n      }\n\n      if (child.name === \"polygon\") {\n        let points\n\n        let temp = s2p.polygon({points});\n        return mjs.importer.fromSVGPathData(temp);\n      }\n\n      if (child.name === \"polyline\") {\n        let points\n\n        let temp = s2p.polyline({points});\n        return mjs.importer.fromSVGPathData(temp);\n      }\n\n      if (child.name === \"line\") {\n        let x1;\n        let x2;\n        let y1;\n        let y2;\n\n        let temp = s2p.line({x1, x2, y1, y2});\n        return mjs.importer.fromSVGPathData(temp);\n      }\n\n      if (child.name === \"path\") {\n        let makerjsPath = mjs.importer.fromSVGPathData(child.attributes.d);\n        return makerjsPath;\n      }\n    }\n\n    //main event\n    let files = e.target.files;\n    let file = files[0];\n\n    var reader = new FileReader();\n\n    reader.onload = (event) => {\n      let text = event.target.result;\n\n      svgson.parse(text).then((json) => {\n        let svg = json.children.map(child => {\n          return replaceWithPath(child);\n        });\n\n        svg = svg.flat(1); //TODO: what does the argument do again?\n\n        //TODO: update state to have makerjs models\n        console.log(\"svg\", svg);\n        let models = {};\n\n        svg.forEach(shape => {\n          models[utils.makeID()] = shape;\n        })\n\n        console.log(\"models\", models);\n\n        //ultimately I will set state of app\n      });\n    };\n\n    reader.readAsText(file);\n  }\n\n  updateFromChild() {\n    console.log(this.state);\n  }\n\n  render() {\n    //should I put everying in a list or all to one model, there seem to be some issues with origins if I mjs.exporter.toSVG() seperately\n    let test = kk;\n    //test = mjs.model.originate(test);\n    let testProfile = test.models.profile;\n    let testPocket = test.models.pocket;\n    let profileCut = profile(testProfile, params);\n    let pocketCut = pocket(testPocket, params);\n\n    // let drawings = [test, profile(test)];\n    // drawings = drawings.map(d => mjs.exporter.toSVG(d));\n\n    //testing if internal outlines will make acceptable pocket paths, appears so\n    //let p2 = pocket(testPocket, params).drawing;\n    let t1 = new mjs.models.Oval(20,20)\n    let t2 = mjs.model.move(new mjs.models.Oval(20,20), [19,0])\n    let test0 = mjs.model.combineUnion(t1, t2);\n    // console.log(\"test0\", test0)\n    let test1 = pocket(test0, params);\n    // console.log(test0)\n    // test0 = mjs.model.move(test0, [50, 0]);\n\n    let model = {\n      models: {\n        shapes: {\n          models: {\n            profileSource: testProfile,\n            pocketSource: testPocket,\n            //test0\n          }\n        },\n        cuts: {\n          models: {\n            profileCut: profileCut.drawing,\n            pocketCut: pocketCut.drawing,\n            //test1: test1.drawing\n          }\n        }\n        //pocketCut2: pocket(p2, params).drawing,\n        // test0,\n        // test1,\n      }\n    }\n\n    model.models.cuts.layer = \"red\";\n\n    // model = mjs.model.originate(model);\n    // model = mjs.model.zero(model);\n\n    model['paths'] = {\n      origin: new mjs.paths.Circle(params.compensatedRadius)\n    }\n\n    let modelToView = mjs.model.scale(utils.deepcopy(model), 10); //TODO: make drawing easier to see, but this ruins toolpaths\n\n    let viewModel = mjs.exporter.toSVG(modelToView, {\n      useSvgPathOnly:true,\n      strokeWidth:\".5mm\",\n      // layerOptions:{\n      //   cuts: {\n      //     stroke: \"red\"\n      //   }\n      // },\n    });\n    //viewModel = viewModel.concat(Object.values(modelToView.models).map(m => mjs.exporter.toSVG(m)));\n    viewModel = [viewModel];\n\n    //let p = material_type(this.state.dialogs.material_type, this);\n\n    return (\n      <div\n        onMouseDown={(e) => console.log(\"div target\", e.target.getAttribute(\"data-route\"))}\n        style={{\n          margin: 0,\n          height: \"100%\",\n          overflow: \"hidden\"\n        }}>\n\n          <Workplane groups={viewModel}/>\n\n        <div>\n          <input\n            id=\"myInput\"\n            type=\"file\"\n            ref={(ref) => this.upload = ref}\n            style={{ display: 'none' }}\n            onChange={(e) => this.uploadSVG(e)}/>\n          <Button\n            variant=\"secondary\"\n            onClick={(e) => this.upload.click()}\n            >\n              upload (SVG, DXF, BBJS, or Makerjs)\n          </Button>\n          &nbsp;\n          <Button\n            onClick={() => {\n              utils.download(test1.filename, test1.gcode);\n              utils.download(profileCut.filename, profileCut.gcode);\n              utils.download(pocketCut.filename, pocketCut.gcode);\n            }}\n            >\n              download gcode\n          </Button>\n          &nbsp;\n          <Button\n            isActive={false}\n            style={{backgroundColor:\"#fff\"}}>\n            save\n          </Button>\n        </div>\n\n        <div>\n          <Heading>Settings</Heading>\n          <MaterialType updateparent={() => this.updateFromChild()}/>\n          <MaterialThickness updateparent={() => this.updateFromChild()}/>\n          <Units updateparent={() => this.updateFromChild()}/>\n          <Origin updateparent={() => this.updateFromChild()}/>\n        </div>\n        <div>\n          <Heading>Create Toolpaths</Heading>\n          <Button>Profile</Button><br/>\n          <PocketButton updateparent={() => this.updateFromChild()}/>\n          <Button>Drill</Button><br/>\n        </div>\n        <div>\n          <Heading>Toolpaths</Heading>\n        </div>\n\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}