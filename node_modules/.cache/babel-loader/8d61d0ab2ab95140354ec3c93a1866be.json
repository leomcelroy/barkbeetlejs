{"ast":null,"code":"import _toConsumableArray from \"/Users/leomcelroy/Desktop/barkBeetleEverything/barkbeetle_js_real/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n// makerjs model, params -> profile toolpath\nimport * as mjs from 'makerjs';\n\nvar profile = function profile(model, params) {\n  console.log(params); //let p = model.models.profile;\n\n  var p = model;\n  var outline = mjs.model.outline(p, params.compensatedRadius, 1, params.insideCutting); //third parameter is what type of corners, 0 (rounded) by default\n  // outline = mjs.model.zero(outline);\n  // let chains = mjs.model.findChains(expansion);\n\n  var chain = mjs.model.findSingleChain(outline); // console.log(\"outline\", outline, \"chain\", chain);\n\n  var divisions = Math.floor(chain.pathLength / params.minimumSpacing);\n  var spacing = chain.pathLength / divisions;\n  var keyPoints = mjs.chain.toPoints(chain, spacing); // let scaleFactor = 10;\n  // let scaleXY = keyPoints.map(p => [p[0] * scaleFactor, p[1] * scaleFactor]);\n\n  var gcodePoints = keyPoints.map(function (p) {\n    return \"G1 X\".concat(p[0], \" Y\").concat(p[1], \" F\").concat(params.feedRate);\n  });\n  var gcode = JSON.parse(JSON.stringify(gcodePoints));\n  var firstPoint = keyPoints[0];\n  var paths = params.depthOfPasses.map(function (p, i) {\n    return [\"G1 Z\".concat(params.depthOfPasses[i], \" F12.0\")].concat(_toConsumableArray(gcode), [\"G1 X\".concat(firstPoint[0], \" Y\").concat(firstPoint[1], \" F\").concat(params.feedRate)]);\n  });\n  paths = paths.flat(1);\n  gcode = [params.units, //units\n  \"G90\", \"G1 Z\".concat(params.jogHeight, \" F9.0\"), \"G0 X\".concat(firstPoint[0], \" Y\").concat(firstPoint[1])].concat(_toConsumableArray(paths)); // write to a new file named\n\n  var filename = 'testGcodeProfile.nc';\n  var text = gcode.join('\\n'); // console.log(\"profile\", outline)\n\n  return {\n    drawing: outline,\n    gcode: text,\n    filename: filename\n  };\n};\n\nexport { profile };","map":{"version":3,"sources":["/Users/leomcelroy/Desktop/barkBeetleEverything/barkbeetle_js_real/src/toolpaths/profile.js"],"names":["mjs","profile","model","params","console","log","p","outline","compensatedRadius","insideCutting","chain","findSingleChain","divisions","Math","floor","pathLength","minimumSpacing","spacing","keyPoints","toPoints","gcodePoints","map","feedRate","gcode","JSON","parse","stringify","firstPoint","paths","depthOfPasses","i","flat","units","jogHeight","filename","text","join","drawing"],"mappings":";AAAA;AAEA,OAAO,KAAKA,GAAZ,MAAqB,SAArB;;AAEA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACC,KAAD,EAAQC,MAAR,EAAmB;AACjCC,EAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ,EADiC,CAEjC;;AACA,MAAIG,CAAC,GAAGJ,KAAR;AAEA,MAAIK,OAAO,GAAGP,GAAG,CAACE,KAAJ,CAAUK,OAAV,CAAkBD,CAAlB,EAAqBH,MAAM,CAACK,iBAA5B,EAA+C,CAA/C,EAAkDL,MAAM,CAACM,aAAzD,CAAd,CALiC,CAKsD;AACvF;AACA;;AACA,MAAIC,KAAK,GAAGV,GAAG,CAACE,KAAJ,CAAUS,eAAV,CAA0BJ,OAA1B,CAAZ,CARiC,CAUjC;;AAEA,MAAIK,SAAS,GAAGC,IAAI,CAACC,KAAL,CAAWJ,KAAK,CAACK,UAAN,GAAmBZ,MAAM,CAACa,cAArC,CAAhB;AACA,MAAIC,OAAO,GAAGP,KAAK,CAACK,UAAN,GAAmBH,SAAjC;AAEA,MAAIM,SAAS,GAAGlB,GAAG,CAACU,KAAJ,CAAUS,QAAV,CAAmBT,KAAnB,EAA0BO,OAA1B,CAAhB,CAfiC,CAiBjC;AACA;;AAEA,MAAIG,WAAW,GAAGF,SAAS,CAACG,GAAV,CAAc,UAAAf,CAAC;AAAA,yBAAWA,CAAC,CAAC,CAAD,CAAZ,eAAoBA,CAAC,CAAC,CAAD,CAArB,eAA6BH,MAAM,CAACmB,QAApC;AAAA,GAAf,CAAlB;AACA,MAAIC,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeN,WAAf,CAAX,CAAZ;AAEA,MAAIO,UAAU,GAAGT,SAAS,CAAC,CAAD,CAA1B;AAEA,MAAIU,KAAK,GAAGzB,MAAM,CAAC0B,aAAP,CAAqBR,GAArB,CAAyB,UAACf,CAAD,EAAGwB,CAAH;AAAA,0BAAiB3B,MAAM,CAAC0B,aAAP,CAAqBC,CAArB,CAAjB,uCAAqDP,KAArD,kBAAmEI,UAAU,CAAC,CAAD,CAA7E,eAAqFA,UAAU,CAAC,CAAD,CAA/F,eAAuGxB,MAAM,CAACmB,QAA9G;AAAA,GAAzB,CAAZ;AACAM,EAAAA,KAAK,GAAGA,KAAK,CAACG,IAAN,CAAW,CAAX,CAAR;AAEAR,EAAAA,KAAK,IACHpB,MAAM,CAAC6B,KADJ,EACW;AACd,OAFG,gBAGI7B,MAAM,CAAC8B,SAHX,0BAIIN,UAAU,CAAC,CAAD,CAJd,eAIsBA,UAAU,CAAC,CAAD,CAJhC,6BAKAC,KALA,EAAL,CA5BiC,CAoCjC;;AACA,MAAIM,QAAQ,GAAG,qBAAf;AAEA,MAAIC,IAAI,GAAGZ,KAAK,CAACa,IAAN,CAAW,IAAX,CAAX,CAvCiC,CAyCjC;;AAEA,SAAO;AAACC,IAAAA,OAAO,EAAE9B,OAAV;AAAmBgB,IAAAA,KAAK,EAAEY,IAA1B;AAAgCD,IAAAA,QAAQ,EAARA;AAAhC,GAAP;AACD,CA5CD;;AA+CA,SAAQjC,OAAR","sourcesContent":["// makerjs model, params -> profile toolpath\n\nimport * as mjs from 'makerjs';\n\nconst profile = (model, params) => {\n  console.log(params);\n  //let p = model.models.profile;\n  let p = model;\n\n  let outline = mjs.model.outline(p, params.compensatedRadius, 1, params.insideCutting); //third parameter is what type of corners, 0 (rounded) by default\n  // outline = mjs.model.zero(outline);\n  // let chains = mjs.model.findChains(expansion);\n  let chain = mjs.model.findSingleChain(outline);\n\n  // console.log(\"outline\", outline, \"chain\", chain);\n\n  var divisions = Math.floor(chain.pathLength / params.minimumSpacing);\n  var spacing = chain.pathLength / divisions;\n\n  let keyPoints = mjs.chain.toPoints(chain, spacing);\n\n  // let scaleFactor = 10;\n  // let scaleXY = keyPoints.map(p => [p[0] * scaleFactor, p[1] * scaleFactor]);\n\n  let gcodePoints = keyPoints.map(p => `G1 X${p[0]} Y${p[1]} F${params.feedRate}`)\n  let gcode = JSON.parse(JSON.stringify(gcodePoints));\n\n  let firstPoint = keyPoints[0];\n\n  let paths = params.depthOfPasses.map((p,i) => [`G1 Z${params.depthOfPasses[i]} F12.0`, ...gcode, `G1 X${firstPoint[0]} Y${firstPoint[1]} F${params.feedRate}`])\n  paths = paths.flat(1);\n\n  gcode = [\n    params.units, //units\n    \"G90\",\n    `G1 Z${params.jogHeight} F9.0`,\n    `G0 X${firstPoint[0]} Y${firstPoint[1]}`,\n    ...paths\n  ]\n\n  // write to a new file named\n  let filename = 'testGcodeProfile.nc';\n\n  let text = gcode.join('\\n');\n\n  // console.log(\"profile\", outline)\n\n  return {drawing: outline, gcode: text, filename};\n};\n\n\nexport {profile};\n"]},"metadata":{},"sourceType":"module"}