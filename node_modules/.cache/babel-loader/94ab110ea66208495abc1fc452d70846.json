{"ast":null,"code":"import { line } from '../unmakerjs/primitives.js';\n\nvar linesToPolylinePoints = function linesToPolylinePoints(lines, lastIndex) {\n  return lines.map(function (line, i) {\n    //should import this instead\n    if (i === lastIndex - 1) return [{\n      x: line.origin[0],\n      y: line.origin[1]\n    }, {\n      x: line.end[0],\n      y: line.end[1]\n    }];\n    return {\n      x: line.origin[0],\n      y: line.origin[1]\n    };\n  }).flat();\n};\n\nvar sum = function sum(a, b) {\n  return a + b;\n};\n\nvar getCenter = function getCenter(contour) {\n  var polyline = linesToPolylinePoints(contour);\n  var xS = polyline.map(function (point) {\n    return point.x;\n  });\n  var averageX = xS.reduce(sum, 0) / xS.length;\n  var yS = polyline.map(function (point) {\n    return point.y;\n  });\n  var averageY = yS.reduce(sum, 0) / yS.length;\n  return [averageX, averageY];\n};\n\nexport var drill = function drill(contour, params) {\n  var center = getCenter(contour);\n  var preamble = [params.units, \"G90\"];\n  var gcode = [].concat(preamble, [\"(end of preamble)\", \"G1 Z\".concat(params.jogHeight, \" F\").concat(params.jogRate), \"G0 X\".concat(center[0], \" Y\").concat(center[1]), \"G0 Z\".concat(params.cutDepth), \"G1 Z\".concat(params.jogHeight, \" F\").concat(params.jogRate)]);\n  var text = gcode.join('\\n');\n  return {\n    drawing: [line(center, [center[0] + 10, center[1] + 10])],\n    gcode: text\n  };\n};","map":{"version":3,"sources":["/Users/leomcelroy/Desktop/barkbeetle_js/src/toolpaths/drill.js"],"names":["line","linesToPolylinePoints","lines","lastIndex","map","i","x","origin","y","end","flat","sum","a","b","getCenter","contour","polyline","xS","point","averageX","reduce","length","yS","averageY","drill","params","center","preamble","units","gcode","jogHeight","jogRate","cutDepth","text","join","drawing"],"mappings":"AAAA,SAAQA,IAAR,QAAmB,4BAAnB;;AAEA,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,KAAD,EAAQC,SAAR;AAAA,SAAsBD,KAAK,CAACE,GAAN,CAAU,UAACJ,IAAD,EAAOK,CAAP,EAAa;AAAE;AAC3E,QAAIA,CAAC,KAAKF,SAAS,GAAC,CAApB,EAAuB,OAAO,CAAC;AAACG,MAAAA,CAAC,EAACN,IAAI,CAACO,MAAL,CAAY,CAAZ,CAAH;AAAmBC,MAAAA,CAAC,EAACR,IAAI,CAACO,MAAL,CAAY,CAAZ;AAArB,KAAD,EAAuC;AAACD,MAAAA,CAAC,EAACN,IAAI,CAACS,GAAL,CAAS,CAAT,CAAH;AAAgBD,MAAAA,CAAC,EAACR,IAAI,CAACS,GAAL,CAAS,CAAT;AAAlB,KAAvC,CAAP;AAEvB,WAAO;AAACH,MAAAA,CAAC,EAACN,IAAI,CAACO,MAAL,CAAY,CAAZ,CAAH;AAAmBC,MAAAA,CAAC,EAACR,IAAI,CAACO,MAAL,CAAY,CAAZ;AAArB,KAAP;AACD,GAJmD,EAIjDG,IAJiD,EAAtB;AAAA,CAA9B;;AAMA,IAAIC,GAAG,GAAG,SAANA,GAAM,CAACC,CAAD,EAAIC,CAAJ;AAAA,SAAUD,CAAC,GAAGC,CAAd;AAAA,CAAV;;AAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,OAAD,EAAa;AAC7B,MAAIC,QAAQ,GAAGf,qBAAqB,CAACc,OAAD,CAApC;AAEA,MAAIE,EAAE,GAAGD,QAAQ,CAACZ,GAAT,CAAa,UAAAc,KAAK;AAAA,WAAIA,KAAK,CAACZ,CAAV;AAAA,GAAlB,CAAT;AACA,MAAIa,QAAQ,GAAGF,EAAE,CAACG,MAAH,CAAUT,GAAV,EAAe,CAAf,IAAkBM,EAAE,CAACI,MAApC;AACA,MAAIC,EAAE,GAAGN,QAAQ,CAACZ,GAAT,CAAa,UAAAc,KAAK;AAAA,WAAIA,KAAK,CAACV,CAAV;AAAA,GAAlB,CAAT;AACA,MAAIe,QAAQ,GAAGD,EAAE,CAACF,MAAH,CAAUT,GAAV,EAAe,CAAf,IAAkBW,EAAE,CAACD,MAApC;AAEA,SAAO,CAACF,QAAD,EAAWI,QAAX,CAAP;AAED,CAVD;;AAYA,OAAO,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAACT,OAAD,EAAUU,MAAV,EAAqB;AACxC,MAAIC,MAAM,GAAGZ,SAAS,CAACC,OAAD,CAAtB;AAEA,MAAIY,QAAQ,GAAG,CAACF,MAAM,CAACG,KAAR,EAAe,KAAf,CAAf;AAEA,MAAIC,KAAK,aACJF,QADI,GAEP,mBAFO,gBAGAF,MAAM,CAACK,SAHP,eAGqBL,MAAM,CAACM,OAH5B,iBAIAL,MAAM,CAAC,CAAD,CAJN,eAIcA,MAAM,CAAC,CAAD,CAJpB,iBAKAD,MAAM,CAACO,QALP,iBAMAP,MAAM,CAACK,SANP,eAMqBL,MAAM,CAACM,OAN5B,GAAT;AASA,MAAIE,IAAI,GAAGJ,KAAK,CAACK,IAAN,CAAW,IAAX,CAAX;AAEA,SAAO;AAACC,IAAAA,OAAO,EAAE,CAACnC,IAAI,CAAC0B,MAAD,EAAQ,CAACA,MAAM,CAAC,CAAD,CAAN,GAAY,EAAb,EAAiBA,MAAM,CAAC,CAAD,CAAN,GAAY,EAA7B,CAAR,CAAL,CAAV;AAA2DG,IAAAA,KAAK,EAAEI;AAAlE,GAAP;AACD,CAjBM","sourcesContent":["import {line} from '../unmakerjs/primitives.js';\n\nconst linesToPolylinePoints = (lines, lastIndex) => lines.map((line, i) => { //should import this instead\n  if (i === lastIndex-1) return [{x:line.origin[0], y:line.origin[1]}, {x:line.end[0], y:line.end[1]}];\n\n  return {x:line.origin[0], y:line.origin[1]}\n}).flat()\n\nlet sum = (a, b) => a + b;\n\nconst getCenter = (contour) => {\n  let polyline = linesToPolylinePoints(contour);\n\n  let xS = polyline.map(point => point.x);\n  let averageX = xS.reduce(sum, 0)/xS.length;\n  let yS = polyline.map(point => point.y);\n  let averageY = yS.reduce(sum, 0)/yS.length;\n\n  return [averageX, averageY];\n\n}\n\nexport const drill = (contour, params) => {\n  let center = getCenter(contour);\n\n  let preamble = [params.units, \"G90\"];\n\n  let gcode = [\n    ...preamble,\n    \"(end of preamble)\",\n    `G1 Z${params.jogHeight} F${params.jogRate}`,\n    `G0 X${center[0]} Y${center[1]}`,\n    `G0 Z${params.cutDepth}`,\n    `G1 Z${params.jogHeight} F${params.jogRate}`,\n  ]\n\n  let text = gcode.join('\\n');\n\n  return {drawing: [line(center,[center[0] + 10, center[1] + 10])], gcode: text};\n};\n"]},"metadata":{},"sourceType":"module"}