{"ast":null,"code":"var _assertThisInitialized = require(\"/Users/leomcelroy/Desktop/barkbeetle_js/node_modules/@babel/runtime/helpers/assertThisInitialized\");\n\nvar _createClass = require(\"/Users/leomcelroy/Desktop/barkbeetle_js/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _classCallCheck = require(\"/Users/leomcelroy/Desktop/barkbeetle_js/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _possibleConstructorReturn = require(\"/Users/leomcelroy/Desktop/barkbeetle_js/node_modules/@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"/Users/leomcelroy/Desktop/barkbeetle_js/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/Users/leomcelroy/Desktop/barkbeetle_js/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _require = require('./utils/objectCreationUtils'),\n    extend = _require.extend;\n\nvar EventTarget = require('./class/EventTarget');\n\nvar SVGPoint = require('./class/SVGPoint');\n\nvar SVGMatrix = require('./class/SVGMatrix');\n\nvar _require2 = require('./class/Node'),\n    SVGElement = _require2.SVGElement,\n    DocumentFragment = _require2.DocumentFragment,\n    Node = _require2.Node,\n    TextNode = _require2.TextNode,\n    Comment = _require2.Comment,\n    AttributeNode = _require2.AttributeNode;\n\nvar sizeOf = require('image-size');\n\nvar path = require('path');\n\nvar fontkit = require('fontkit');\n\nvar _require3 = require('./utils/strUtils'),\n    htmlEntities = _require3.htmlEntities;\n\nvar HTMLLinkElement =\n/*#__PURE__*/\nfunction (_Node) {\n  \"use strict\";\n\n  _inherits(HTMLLinkElement, _Node);\n\n  function HTMLLinkElement() {\n    _classCallCheck(this, HTMLLinkElement);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(HTMLLinkElement).call(this, 'link'));\n  }\n\n  return HTMLLinkElement;\n}(Node);\n\nObject.defineProperties(HTMLLinkElement.prototype, {\n  href: {\n    get: function get() {\n      return this.attrs.get('href');\n    },\n    set: function set(val) {\n      this.attrs.set('href', val);\n    }\n  },\n  rel: {\n    get: function get() {\n      return this.attrs.get('rel');\n    },\n    set: function set(val) {\n      this.attrs.set('rel', val);\n    }\n  },\n  type: {\n    get: function get() {\n      return this.attrs.get('type');\n    },\n    set: function set(val) {\n      this.attrs.set('type', val);\n    }\n  }\n});\n\nvar HTMLScriptElement =\n/*#__PURE__*/\nfunction (_Node2) {\n  \"use strict\";\n\n  _inherits(HTMLScriptElement, _Node2);\n\n  function HTMLScriptElement() {\n    _classCallCheck(this, HTMLScriptElement);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(HTMLScriptElement).call(this, 'script'));\n  }\n\n  return HTMLScriptElement;\n}(Node);\n\nObject.defineProperties(HTMLScriptElement.prototype, {\n  src: {\n    get: function get() {\n      return this.attrs.get('src');\n    },\n    set: function set(val) {\n      this.attrs.set('src', val);\n    }\n  },\n  type: {\n    get: function get() {\n      return this.attrs.get('type');\n    },\n    set: function set(val) {\n      this.attrs.set('type', val);\n    }\n  }\n});\n\nvar HTMLImageElement =\n/*#__PURE__*/\nfunction (_Node3) {\n  \"use strict\";\n\n  _inherits(HTMLImageElement, _Node3);\n\n  function HTMLImageElement() {\n    var _this;\n\n    _classCallCheck(this, HTMLImageElement);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(HTMLImageElement).call(this, 'img'));\n    _this.width = 0;\n    _this.height = 0;\n    _this.naturalWidth = 0;\n    _this.naturalHeight = 0;\n    return _this;\n  }\n\n  return HTMLImageElement;\n}(Node);\n\nObject.defineProperties(HTMLImageElement.prototype, {\n  src: {\n    get: function get() {\n      return this.attrs.get('src');\n    },\n    set: function set(val) {\n      var _this2 = this;\n\n      this.attrs.set('src', val);\n      sizeOf(val, function (err, size) {\n        if (err) {\n          _this2.dispatchEvent(new Event('error', _this2));\n\n          return;\n        }\n\n        _this2.width = _this2.naturalWidth = size.width;\n        _this2.height = _this2.naturalHeight = size.height;\n\n        _this2.dispatchEvent(new Event('load', _this2));\n      });\n    }\n  },\n  height: {\n    get: function get() {\n      return this.attrs.get('height');\n    },\n    set: function set(val) {\n      this.attrs.set('height', val);\n    }\n  },\n  width: {\n    get: function get() {\n      return this.attrs.get('width');\n    },\n    set: function set(val) {\n      this.attrs.set('width', val);\n    }\n  }\n});\n\nvar Event =\n/*#__PURE__*/\nfunction () {\n  \"use strict\";\n\n  function Event(type) {\n    _classCallCheck(this, Event);\n\n    this.type = type;\n    this.cancelable = false;\n    this.defaultPrevented = false;\n  }\n\n  _createClass(Event, [{\n    key: \"preventDefault\",\n    value: function preventDefault() {\n      this.defaultPrevented = true;\n    }\n  }]);\n\n  return Event;\n}();\n\nvar CustomEvent =\n/*#__PURE__*/\nfunction (_Event) {\n  \"use strict\";\n\n  _inherits(CustomEvent, _Event);\n\n  function CustomEvent(name) {\n    var _this3;\n\n    var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, CustomEvent);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(CustomEvent).call(this, name));\n    _this3.detail = props.detail || null;\n    _this3.cancelable = props.cancelable || false;\n    return _this3;\n  }\n\n  return CustomEvent;\n}(Event); // Feature/version pairs that DOMImplementation.hasFeature() returns true for.  It returns false for anything else.\n\n\nvar supportedFeatures = {\n  'xml': {\n    '': true,\n    '1.0': true,\n    '2.0': true\n  },\n  // DOM Core\n  'core': {\n    '': true,\n    '2.0': true\n  },\n  // DOM Core\n  'html': {\n    '': true,\n    '1.0': true,\n    '2.0': true\n  },\n  // HTML\n  'xhtml': {\n    '': true,\n    '1.0': true,\n    '2.0': true // HTML\n\n  }\n};\n\nvar DOMImplementation =\n/*#__PURE__*/\nfunction () {\n  \"use strict\";\n\n  function DOMImplementation() {\n    _classCallCheck(this, DOMImplementation);\n  }\n\n  _createClass(DOMImplementation, [{\n    key: \"hasFeature\",\n    value: function hasFeature(feature, version) {\n      var f = supportedFeatures[(feature || '').toLowerCase()];\n      return f && f[version || ''] || false;\n    }\n  }, {\n    key: \"createDocumentType\",\n    value: function createDocumentType(qualifiedName, publicId, systemId) {\n      throw new Error('createDocumentType not implemented yet');\n    }\n  }, {\n    key: \"createDocument\",\n    value: function createDocument(namespace, qualifiedName, doctype) {\n      var doc = new Document();\n\n      if (doctype) {\n        if (doctype.ownerDocument) {\n          throw new Error('the object is in the wrong Document, a call to importNode is required');\n        }\n\n        doc.appendChild(doctype);\n      }\n\n      if (qualifiedName) {\n        doc.appendChild(doc.createElementNS(namespace, qualifiedName));\n      }\n\n      return doc;\n    }\n  }, {\n    key: \"createHTMLDocument\",\n    value: function createHTMLDocument(titleText) {\n      var d = new Document('html');\n      var root = d.documentElement;\n      var head = d.createElement('head');\n      root.appendChild(head);\n      var title = d.createElement('title');\n      head.appendChild(title);\n      title.appendChild(d.createTextNode(titleText));\n      root.appendChild(d.createElement('body'));\n      return d;\n    }\n  }]);\n\n  return DOMImplementation;\n}();\n\nfunction getChildByTagName(parent, name) {\n  for (var child = parent.firstChild; child != null; child = child.nextSibling) {\n    if (child.nodeType === Node.ELEMENT_NODE && child.nodeName === name) {\n      return child;\n    }\n  }\n\n  return null;\n}\n\nvar Document =\n/*#__PURE__*/\nfunction (_Node4) {\n  \"use strict\";\n\n  _inherits(Document, _Node4);\n\n  function Document(root) {\n    var _this4;\n\n    _classCallCheck(this, Document);\n\n    _this4 = _possibleConstructorReturn(this, _getPrototypeOf(Document).call(this, '#document'));\n    _this4.nodeType = Node.DOCUMENT_NODE;\n    root = _this4.createElement(root);\n\n    _this4.appendChild(root);\n\n    root.ownerDocument = _assertThisInitialized(_assertThisInitialized(_this4));\n    _this4.documentElement = root;\n    _this4._preloaded = {};\n    _this4._implementation = new DOMImplementation();\n    return _this4;\n  }\n\n  _createClass(Document, [{\n    key: \"createElementNS\",\n    value: function createElementNS(ns, name) {\n      return new SVGElement(name, {\n        attrs: {\n          xmlns: ns\n        },\n        ownerDocument: this\n      });\n    }\n  }, {\n    key: \"createDocumentFragment\",\n    value: function createDocumentFragment(name) {\n      return new DocumentFragment();\n    }\n  }, {\n    key: \"createElement\",\n    value: function createElement(name) {\n      switch (name) {\n        case 'img':\n          return new HTMLImageElement({\n            ownerDocument: this\n          });\n\n        case 'link':\n          return new HTMLLinkElement({\n            ownerDocument: this\n          });\n\n        case 'script':\n          return new HTMLScriptElement({\n            ownerDocument: this\n          });\n\n        default:\n          return new SVGElement(name, {\n            ownerDocument: this\n          });\n      }\n    }\n  }, {\n    key: \"createTextNode\",\n    value: function createTextNode(text) {\n      return new TextNode('#text', {\n        data: htmlEntities(text),\n        ownerDocument: this\n      });\n    }\n  }, {\n    key: \"createComment\",\n    value: function createComment(text) {\n      return new Comment('#comment', {\n        data: text,\n        ownerDocument: this\n      });\n    }\n  }, {\n    key: \"createAttribute\",\n    value: function createAttribute(name) {\n      return new AttributeNode(name, {\n        ownerDocument: this\n      });\n    }\n  }]);\n\n  return Document;\n}(Node);\n\nObject.defineProperties(Document.prototype, {\n  implementation: {\n    get: function get() {\n      return this._implementation;\n    }\n  },\n  compatMode: {\n    get: function get() {\n      return 'CSS1Compat'; // always be in standards-mode\n    }\n  },\n  body: {\n    get: function get() {\n      return getChildByTagName(this.documentElement, 'body');\n    },\n    set: function set() {\n      throw new Error('setting body not implemented yet');\n    }\n  },\n  head: {\n    get: function get() {\n      return getChildByTagName(this.documentElement, 'head');\n    }\n  }\n});\n\nvar Window =\n/*#__PURE__*/\nfunction (_EventTarget) {\n  \"use strict\";\n\n  _inherits(Window, _EventTarget);\n\n  function Window() {\n    var _this5;\n\n    _classCallCheck(this, Window);\n\n    _this5 = _possibleConstructorReturn(this, _getPrototypeOf(Window).call(this));\n    _this5.document = new Document('svg');\n    return _this5;\n  }\n\n  _createClass(Window, [{\n    key: \"setFontDir\",\n    value: function setFontDir(dir) {\n      this.document.fontDir = dir;\n      return this;\n    }\n  }, {\n    key: \"setFontFamilyMappings\",\n    value: function setFontFamilyMappings(map) {\n      this.document.fontFamilyMappings = map;\n      return this;\n    }\n  }, {\n    key: \"preloadFonts\",\n    value: function preloadFonts() {\n      var map = this.document.fontFamilyMappings;\n      var filename;\n\n      for (var i in map) {\n        filename = path.join(this.document.fontDir, map[i]);\n\n        try {\n          this.document._preloaded[i] = fontkit.openSync(filename);\n        } catch (e) {\n          console.warn('Could not load font file for ' + i + '.' + e);\n        }\n      }\n\n      return this;\n    }\n  }, {\n    key: \"getComputedStyle\",\n    value: function getComputedStyle(node) {\n      return {\n        // FIXME: Currently this function treats every given attr\n        // as inheritable from its parents which is ofc not always true\n        // but good enough for svg.js\n        getPropertyValue: function getPropertyValue(attr) {\n          var value;\n\n          do {\n            value = node.style[attr] || node.getAttribute(attr);\n          } while (value == null && (node = node.parentNode) && node.nodeType === 1);\n\n          return value || null;\n        }\n      };\n    }\n  }]);\n\n  return Window;\n}(EventTarget);\n\nextend(Window, {\n  Window: Window,\n  DocumentFragment: DocumentFragment,\n  Node: Node,\n  Text: TextNode,\n  Element: SVGElement,\n  SVGElement: SVGElement,\n  CustomEvent: CustomEvent,\n  Event: Event,\n  SVGMatrix: SVGMatrix,\n  SVGPoint: SVGPoint,\n  HTMLLinkElement: HTMLLinkElement,\n  HTMLScriptElement: HTMLScriptElement,\n  Image: HTMLImageElement,\n  HTMLImageElement: HTMLImageElement,\n  setTimeout: setTimeout,\n  clearTimeout: clearTimeout,\n  pageXOffset: 0,\n  pageYOffset: 0\n});\nmodule.exports = new Window();","map":null,"metadata":{},"sourceType":"script"}