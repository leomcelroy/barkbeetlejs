{"ast":null,"code":"import _toConsumableArray from \"/Users/leomcelroy/Desktop/barkbeetle_js/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/leomcelroy/Desktop/barkbeetle_js/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/leomcelroy/Desktop/barkbeetle_js/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/leomcelroy/Desktop/barkbeetle_js/src/App.js\";\nimport React, { Component, PureComponent, useState } from 'react';\nimport { Button, Heading, Pane, Paragraph } from 'evergreen-ui';\nimport './App.css';\nimport { UncontrolledReactSVGPanZoom } from 'react-svg-pan-zoom';\nimport simplify from 'simplify-js';\nimport * as utils from './utils.js';\nimport * as mjs from 'makerjs';\nimport * as params from './parameters.js';\nimport * as s2p from 'shape2path';\nimport * as svgson from 'svgson';\nimport { uploadSVG, uploadBBJS } from './uploadSVG.js';\nimport { Workplane } from './Workplane.js';\nimport { MaterialType } from './components/MaterialType.js';\nimport { MaterialThickness } from './components/MaterialThickness.js';\nimport { Origin } from './components/Origin.js';\nimport { Units } from './components/Units.js';\nimport { PocketButton } from './components/PocketButton.js';\nimport { ProfileButton } from './components/ProfileButton.js';\nimport { DrillButton } from './components/DrillButton.js';\nimport { AdvancedOptions } from './components/AdvancedOptions.js';\nimport { ToolpathList } from './components/ToolpathList.js';\nimport { renderLine, connectPoints } from './unmakerjs/primitives.js';\nimport store from \"./store.js\"; //this is my global state library, this is the only file that will getState() it will pass that to all sub components or should i import store in respective components\n\nvar TOLERANCE = 1.5;\nvar HQ = false;\n\nvar linesToPolylinePoints = function linesToPolylinePoints(lines, lastIndex) {\n  return lines.map(function (line, i) {\n    if (i === lastIndex - 1) return [{\n      x: line.origin[0],\n      y: line.origin[1]\n    }, {\n      x: line.end[0],\n      y: line.end[1]\n    }];\n    return {\n      x: line.origin[0],\n      y: line.origin[1]\n    };\n  }).flat();\n};\n\nvar simplifyLines = function simplifyLines(lines) {\n  return connectPoints(simplify(linesToPolylinePoints(lines, lines.length), TOLERANCE, HQ).map(function (el) {\n    return [el.x, el.y];\n  }));\n};\n\nvar simplifyToolpath = function simplifyToolpath(toolpath) {\n  return toolpath.map(function (lines) {\n    if (!Array.isArray(lines[0])) return simplifyLines(lines, lines.length);\n    return lines.map(function (lines2) {\n      return simplifyLines(lines2, lines2.length);\n    }).flat();\n  }).flat();\n};\n\nvar App = function App() {\n  var _useState = useState({\n    thicknessSubmit: false,\n    materialSubmit: false,\n    originSubmit: false,\n    initialized: true,\n    //will be false\n    groupHovered: []\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var firstSubmit = function firstSubmit(name) {\n    var old = state;\n    old[name] = true;\n    setState(_objectSpread({}, state, {\n      old: old\n    }));\n  };\n\n  var initialized = function initialized() {\n    if (!state.initialized && state.thicknessSubmit && state.materialSubmit && state.originSubmit) {\n      setState(_objectSpread({}, state, {\n        initialized: true\n      }));\n    }\n  };\n\n  var groupHover = function groupHover(id, enter) {\n    id = id.split('_');\n    var toolpath = id[1] === \"toolpath\";\n    id = id[0];\n    var currentGroupHovered = state.groupHovered;\n    currentGroupHovered.push(id);\n\n    if (id && !toolpath && enter) {\n      setState(_objectSpread({}, state, {\n        groupHovered: currentGroupHovered\n      }));\n    } else {\n      setState(_objectSpread({}, state, {\n        groupHovered: []\n      }));\n    }\n  };\n\n  var hover = function hover(id) {\n    id = id.split('_');\n    var toolpath = id[1] === \"toolpath\";\n    id = id[0];\n\n    if (id && !toolpath) {\n      store.update({\n        hovered: [id]\n      });\n    } else {\n      store.update({\n        hovered: []\n      }); //this is a bit hackish\n    }\n  };\n\n  var select = function select(id) {\n    id = id.split('_');\n    var toolpath = id[1] === \"toolpath\";\n    id = id[0];\n\n    if (id && !store.state.selected.includes(id) && !toolpath) {\n      store.update(function (s) {\n        return s.selected.push(id);\n      });\n      ;\n    } else {\n      store.update({\n        selected: []\n      }); //this is a bit hackish\n    }\n  }; //should I put everying in a list or all to one model, there seem to be some issues with origins if I mjs.exporter.toSVG() seperately\n\n\n  if (!state.initialized) initialized();\n  console.log(\"re-rendered\");\n  var viewModel = Object.entries(store.state.contours).map(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        id = _ref2[0],\n        lines = _ref2[1];\n\n    return React.createElement(\"g\", {\n      onMouseEnter: function onMouseEnter(e) {\n        return groupHover(e.target.parentNode.id, true);\n      },\n      onMouseLeave: function onMouseLeave(e) {\n        return groupHover(e.target.parentNode.id, false);\n      },\n      key: \"\".concat(id),\n      id: \"\".concat(id, \"_contour\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, simplifyLines(lines, lines.length).map(function (line, i) {\n      return renderLine(line, \"\".concat(id, \"_index\").concat(i), {\n        selected: store.state.selected.includes(id),\n        highlighted: state.groupHovered.includes(id)\n      });\n    }));\n  });\n  var toolpathView = store.state.toolpaths.map(function (toolpath) {\n    return React.createElement(\"g\", {\n      key: \"\".concat(toolpath.id),\n      id: \"\".concat(toolpath.id, \"_toolpath\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, toolpath.visible && simplifyToolpath(toolpath.geometry.drawing).map(function (line, i) {\n      return renderLine(line, \"\".concat(toolpath.id, \"_index\").concat(i), {\n        toolpath: true\n      });\n    }));\n  });\n  viewModel = [].concat(_toConsumableArray(viewModel), _toConsumableArray(toolpathView));\n  return React.createElement(\"div\", {\n    className: \"wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    onMouseDown: function onMouseDown(e) {\n      return select(e.target.parentNode.id);\n    },\n    className: \"mainEvent\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(Workplane, {\n    groups: viewModel,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }), React.createElement(\"svg\", {\n    width: 0,\n    height: 0,\n    id: \"thisIsDumb\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    id: \"myInput\",\n    type: \"file\",\n    style: {\n      display: 'none'\n    },\n    onChange: function onChange(e) {\n      var files = e.target.files;\n      var file = files[0];\n      var filetype = file.name.split('.')[1];\n      if (filetype === \"bbjs\") return uploadBBJS(e);\n      if (filetype === \"svg\") return uploadSVG(e);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }), React.createElement(Button, {\n    marginRight: 4,\n    onClick: function onClick(e) {\n      return console.log(\"need to fix this\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, \"upload (SVG or BBJS)\"), React.createElement(Button, {\n    onClick: function onClick() {\n      utils.download(\"save.bbjs\", JSON.stringify(store.state));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, \"save\"), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }), \"Number Selected: \", store.state.selected.length, \"\\xA0\", React.createElement(Button, {\n    onClick: function onClick() {\n      var contours = Object.entries(store.state.contours);\n      contours = contours.filter(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            id = _ref4[0],\n            contour = _ref4[1];\n\n        return !store.state.selected.includes(id);\n      });\n      var toolpaths = store.state.toolpaths.filter(function (toolpath) {\n        return !store.state.selected.includes(toolpath.sourceGeometryID);\n      });\n      var newContours = {};\n      contours.forEach(function (contour) {\n        newContours[contour[0]] = contour[1];\n      });\n      contours = newContours;\n      store.update({\n        contours: contours,\n        toolpaths: toolpaths,\n        selected: []\n      });\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, \"Delete\"))), React.createElement(\"div\", {\n    className: \"sidebar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }, React.createElement(Heading, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213\n    },\n    __self: this\n  }, \"Settings\"), React.createElement(Pane, {\n    marginTop: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, \" \", React.createElement(MaterialType, {\n    firstSubmit: firstSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  })), React.createElement(Pane, {\n    marginTop: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }, \" \", React.createElement(MaterialThickness, {\n    firstSubmit: firstSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  })), React.createElement(Pane, {\n    marginTop: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, \" \", React.createElement(Units, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  })), React.createElement(Pane, {\n    marginTop: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, \" \", React.createElement(Origin, {\n    firstSubmit: firstSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  })), !state.initialized ? React.createElement(Paragraph, {\n    marginTop: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, \"select settings before editting options\") : \"\", React.createElement(Pane, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, \" \", React.createElement(AdvancedOptions, {\n    disabled: !state.initialized,\n    setDefault: true,\n    params: store.getState().defaultParameters,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, React.createElement(Heading, {\n    marginTop: 8,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }, \"Create Toolpaths\"), !state.initialized ? React.createElement(Paragraph, {\n    marginTop: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }, \"select settings before creating toolpaths\") : \"\", React.createElement(\"div\", {\n    className: \"toolpaths\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }, React.createElement(Pane, {\n    marginLeft: 8,\n    marginTop: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226\n    },\n    __self: this\n  }, React.createElement(ProfileButton, {\n    disabled: !state.initialized,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226\n    },\n    __self: this\n  })), React.createElement(Pane, {\n    marginLeft: 8,\n    marginTop: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }, React.createElement(PocketButton, {\n    disabled: !state.initialized,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  })), React.createElement(Pane, {\n    marginLeft: 8,\n    marginTop: 4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  }, React.createElement(DrillButton, {\n    disabled: !state.initialized,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  })))), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232\n    },\n    __self: this\n  }, React.createElement(Heading, {\n    marginTop: 8,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233\n    },\n    __self: this\n  }, \"Toolpaths\"), React.createElement(ToolpathList, {\n    marginTop: 4,\n    state: store.getState(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }))));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/leomcelroy/Desktop/barkbeetle_js/src/App.js"],"names":["React","Component","PureComponent","useState","Button","Heading","Pane","Paragraph","UncontrolledReactSVGPanZoom","simplify","utils","mjs","params","s2p","svgson","uploadSVG","uploadBBJS","Workplane","MaterialType","MaterialThickness","Origin","Units","PocketButton","ProfileButton","DrillButton","AdvancedOptions","ToolpathList","renderLine","connectPoints","store","TOLERANCE","HQ","linesToPolylinePoints","lines","lastIndex","map","line","i","x","origin","y","end","flat","simplifyLines","length","el","simplifyToolpath","toolpath","Array","isArray","lines2","App","thicknessSubmit","materialSubmit","originSubmit","initialized","groupHovered","state","setState","firstSubmit","name","old","groupHover","id","enter","split","currentGroupHovered","push","hover","update","hovered","select","selected","includes","s","console","log","viewModel","Object","entries","contours","e","target","parentNode","highlighted","toolpathView","toolpaths","visible","geometry","drawing","display","files","file","filetype","download","JSON","stringify","filter","contour","sourceGeometryID","newContours","forEach","getState","defaultParameters"],"mappings":"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","sourcesContent":["import React, { Component, PureComponent, useState } from 'react';\nimport {Button, Heading, Pane, Paragraph} from 'evergreen-ui';\nimport './App.css';\n\nimport {UncontrolledReactSVGPanZoom} from 'react-svg-pan-zoom';\n\nimport simplify from 'simplify-js';\n\nimport * as utils from './utils.js';\nimport * as mjs from 'makerjs';\nimport * as params from './parameters.js';\nimport * as s2p from 'shape2path';\nimport * as svgson from 'svgson';\n\nimport {uploadSVG, uploadBBJS} from './uploadSVG.js';\n\nimport {Workplane} from './Workplane.js'\nimport {MaterialType} from './components/MaterialType.js';\nimport {MaterialThickness} from './components/MaterialThickness.js';\nimport {Origin} from './components/Origin.js';\nimport {Units} from './components/Units.js';\nimport {PocketButton} from './components/PocketButton.js';\nimport {ProfileButton} from './components/ProfileButton.js';\nimport {DrillButton} from './components/DrillButton.js';\nimport {AdvancedOptions} from './components/AdvancedOptions.js';\nimport {ToolpathList} from './components/ToolpathList.js';\n\nimport {renderLine, connectPoints} from './unmakerjs/primitives.js';\n\nimport store from \"./store.js\"; //this is my global state library, this is the only file that will getState() it will pass that to all sub components or should i import store in respective components\n\nconst TOLERANCE = 1.5;\nconst HQ = false;\n\nconst linesToPolylinePoints = (lines, lastIndex) => lines.map((line, i) => {\n  if (i === lastIndex-1) return [{x:line.origin[0], y:line.origin[1]}, {x:line.end[0], y:line.end[1]}];\n\n  return {x:line.origin[0], y:line.origin[1]}\n}).flat()\n\nconst simplifyLines = (lines) => connectPoints(simplify(linesToPolylinePoints(lines, lines.length), TOLERANCE, HQ).map(el => [el.x, el.y]));\n\nconst simplifyToolpath = (toolpath) => toolpath.map(lines => {\n  if (!Array.isArray(lines[0])) return simplifyLines(lines, lines.length);\n\n  return lines.map(lines2 => simplifyLines(lines2, lines2.length)).flat();\n}).flat()\n\nconst App = () => {\n\n  const [state, setState] = useState({\n    thicknessSubmit : false,\n    materialSubmit: false,\n    originSubmit: false,\n    initialized: true, //will be false\n    groupHovered: [],\n  });\n\n  const firstSubmit = (name) => {\n    let old = state;\n    old[name] = true;\n\n    setState({...state, old});\n  }\n\n  const initialized = () => {\n    if (!state.initialized && (state.thicknessSubmit && state.materialSubmit && state.originSubmit)) {\n      setState({...state, initialized:true});\n    }\n  }\n\n  const groupHover = (id, enter) => {\n    id = id.split('_');\n    let toolpath = (id[1] === \"toolpath\")\n    id = id[0];\n\n    let currentGroupHovered = state.groupHovered;\n    currentGroupHovered.push(id);\n\n\n    if (id && !toolpath && enter) {\n      setState({...state, groupHovered: currentGroupHovered});\n    } else {\n      setState({...state, groupHovered: []});\n    }\n\n  }\n\n  const hover = (id) => {\n    id = id.split('_');\n    let toolpath = (id[1] === \"toolpath\")\n\n    id = id[0];\n\n    if (id && !toolpath) {\n      store.update({ hovered: [id] });\n    } else {\n      store.update({ hovered: [] }); //this is a bit hackish\n    }\n\n  }\n\n  const select = (id) => {\n    id = id.split('_');\n    let toolpath = (id[1] === \"toolpath\")\n\n    id = id[0];\n\n    if (id && !store.state.selected.includes(id) && !toolpath) {\n      store.update(s => s.selected.push(id));;\n    } else {\n      store.update({selected: []}); //this is a bit hackish\n    }\n\n  }\n\n\n\n    //should I put everying in a list or all to one model, there seem to be some issues with origins if I mjs.exporter.toSVG() seperately\n    if (!state.initialized) initialized();\n    console.log(\"re-rendered\")\n\n    let viewModel = Object.entries(store.state.contours).\n                      map(([id, lines]) => <g\n                                            onMouseEnter={(e) => groupHover(e.target.parentNode.id, true)}\n                                            onMouseLeave={(e) => groupHover(e.target.parentNode.id, false)}\n                                            key={`${id}`}\n                                            id={`${id}_contour`}>\n                                            {simplifyLines(lines, lines.length).map((line, i) => renderLine(line, `${id}_index${i}`, {selected: store.state.selected.includes(id), highlighted: state.groupHovered.includes(id)} ))}\n                                           </g>);\n\n   let toolpathView = store.state.toolpaths.\n                     map(toolpath => <g\n                                       key={`${toolpath.id}`}\n                                       id={`${toolpath.id}_toolpath`}>\n                                       {toolpath.visible && simplifyToolpath(toolpath.geometry.drawing).map((line, i) => renderLine(line, `${toolpath.id}_index${i}`, {toolpath: true}))}\n                                      </g>);\n\n\n    viewModel = [...viewModel, ...toolpathView]\n\n    return (\n      <div\n        className=\"wrapper\"\n        >\n\n\n        <div>\n          <div\n            onMouseDown={(e) => select(e.target.parentNode.id)}\n            className=\"mainEvent\">\n            <Workplane groups={viewModel}/>\n            <svg width={0} height={0} id={\"thisIsDumb\"}></svg>\n          </div>\n\n          <div>\n            <input\n              id=\"myInput\"\n              type=\"file\"\n              style={{ display: 'none' }}\n              onChange={(e) => {\n                let files = e.target.files;\n                let file = files[0];\n\n                let filetype = file.name.split('.')[1];\n\n                if (filetype === \"bbjs\") return uploadBBJS(e);\n                if (filetype === \"svg\") return uploadSVG(e)\n              }}/>\n            <Button\n              marginRight={4}\n              onClick={(e) => console.log(\"need to fix this\")}>\n                upload (SVG or BBJS)\n            </Button>\n            <Button\n              onClick={() => {\n                utils.download(\"save.bbjs\", JSON.stringify(store.state));\n                }}>\n              save\n            </Button>\n            <br/>\n            Number Selected: {store.state.selected.length}\n            &nbsp;\n            <Button\n              onClick={() => {\n                let contours = Object.entries(store.state.contours);\n                contours = contours.filter(([id, contour]) => !store.state.selected.includes(id))\n\n                let toolpaths = store.state.toolpaths.filter(toolpath => !store.state.selected.includes(toolpath.sourceGeometryID));\n\n                let newContours = {};\n\n                contours.forEach(contour => {\n                  newContours[contour[0]] = contour[1];\n                })\n\n                contours = newContours;\n\n                store.update({\n                  contours,\n                  toolpaths,\n                  selected: []\n                })\n\n              }}>\n              Delete\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"sidebar\">\n          <div>\n            <Heading>Settings</Heading>\n            <Pane marginTop={4}> <MaterialType firstSubmit={firstSubmit}/></Pane>\n            <Pane marginTop={4}> <MaterialThickness firstSubmit={firstSubmit}/></Pane>\n            <Pane marginTop={4}> <Units/></Pane>\n            <Pane marginTop={4}> <Origin firstSubmit={firstSubmit}/></Pane>\n            {(!state.initialized) ? <Paragraph marginTop={4}>select settings before editting options</Paragraph> : \"\"}\n            <Pane> <AdvancedOptions disabled={!state.initialized} setDefault={true} params={store.getState().defaultParameters}/></Pane>\n          </div>\n\n          <div>\n            <Heading marginTop={8}>Create Toolpaths</Heading>\n            {(!state.initialized) ? <Paragraph marginTop={4}>select settings before creating toolpaths</Paragraph> : \"\"}\n            <div className=\"toolpaths\">\n              <Pane marginLeft={8} marginTop={4}><ProfileButton disabled={!state.initialized}/></Pane>\n              <Pane marginLeft={8} marginTop={4}><PocketButton disabled={!state.initialized}/></Pane>\n              <Pane marginLeft={8} marginTop={4}><DrillButton disabled={!state.initialized}/></Pane>\n            </div>\n          </div>\n\n          <div>\n            <Heading marginTop={8}>Toolpaths</Heading>\n            <ToolpathList marginTop={4} state={store.getState()}/>\n          </div>\n        </div>\n      </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}